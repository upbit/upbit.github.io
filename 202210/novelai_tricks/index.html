<!doctype html><html lang=zh-cn><head><title>NovelAI / Waifu Diffusion 风格技巧整理 - 01基础风格 // 夢沉抹大拉</title><link rel="shortcut icon" href=/favicon.ico><meta charset=utf-8><meta name=generator content="Hugo 0.104.3"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Zhou Hao"><meta name=description content="NovelAI / Waifu Diffusion style skills - 01 basic styles"><link rel=stylesheet href=https://blog.imaou.com/css/main.min.0fb49e70a30412f97ddfc418e18fefef1d9fcdebe45f634dbbba768b00fe1eec.css><meta name=twitter:card content="summary"><meta name=twitter:title content="NovelAI / Waifu Diffusion 风格技巧整理 - 01基础风格"><meta name=twitter:description content="NovelAI / Waifu Diffusion style skills - 01 basic styles"><meta property="og:title" content="NovelAI / Waifu Diffusion 风格技巧整理 - 01基础风格"><meta property="og:description" content="NovelAI / Waifu Diffusion style skills - 01 basic styles"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.imaou.com/202210/novelai_tricks/"><meta property="article:section" content="post"><meta property="article:published_time" content="2022-10-09T20:20:00+08:00"><meta property="article:modified_time" content="2022-10-09T20:20:00+08:00"></head><body><header class=app-header><a href=https://blog.imaou.com><img class=app-header-avatar src=/avatar.jpg alt="Zhou Hao"></a>
<span class=app-header-title>夢沉抹大拉</span><nav class=app-header-menu><a class=app-header-menu-item href=/>Blog</a>
-
<a class=app-header-menu-item href=/page/about/>About</a></nav><p>一个追寻抹大拉之地的geeker</p><div class=app-header-social><a href=https://github.com/upbit target=_blank rel="noreferrer noopener me"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github"><title>GitHub</title><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a><a href=https://upbit.artstation.com/ target=_blank rel="noreferrer noopener me"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-aperture"><title>ArtStation</title><circle cx="12" cy="12" r="10"/><line x1="14.31" y1="8" x2="20.05" y2="17.94"/><line x1="9.69" y1="8" x2="21.17" y2="8"/><line x1="7.38" y1="12" x2="13.12" y2="2.06"/><line x1="9.69" y1="16" x2="3.95" y2="6.06"/><line x1="14.31" y1="16" x2="2.83" y2="16"/><line x1="16.62" y1="12" x2="10.88" y2="21.94"/></svg></a></div></header><main class=app-container><article class=post><header class=post-header><h1 class=post-title>NovelAI / Waifu Diffusion 风格技巧整理 - 01基础风格</h1><div class=post-meta><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar"><title>calendar</title><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Oct 9, 2022</div><div><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock"><title>clock</title><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>4 min read</div></div></header><div class=post-content><p>ps: 因为用的full模型，如果文中引用图片不适请联系我替换或删除</p><h2 id=前言>前言</h2><blockquote><p>Stable Diffusion确实可玩性很高，十一玩了很久的 Waifu Diffusion，还开了个<a href=https://upbit.artstation.com/>ArtStation账号</a>记录生成作品的Prompt和Seeds，方便回顾生成得不错的作品。</p><p><img src=000.webp alt=artstation_intro.png></p><p>这两天看到NovelAI泄漏，对堪称<strong>召唤魔法</strong>的Prompt选择很感兴趣，于是做了些尝试在此记录下，方便日后召唤想要的人物。不过NovelAI因为众所周知的原因，生成的人物画风比较趋同。个人觉得看久了会腻（油腻的意义上&mldr;）</p><p>不过再吐槽一句， <a href=https://huggingface.co/hakurei/waifu-diffusion>hakurei/waifu-diffusion</a> 更新到v1.3后，同样prompt/seed下1.3风格有点过度，而且<code>full body</code>描述容易出现没头的情况（v1.2很少遇到）</p></blockquote><h2 id=相关资料备忘>相关资料备忘</h2><blockquote><ol><li>简单易用的SD WebUI，支持 NovelAI。强烈推荐：<a href=https://github.com/AUTOMATIC1111/stable-diffusion-webui>AUTOMATIC1111 WebUI</a></li><li>知乎：NovelAI 魔法术式基础，适合初学者形成概念的好教程：<a href=https://www.zhihu.com/question/558019952/answer/2710009035>《参同真解》</a>
2.b 知乎：现代魔法师修真手稿：<a href=https://zhuanlan.zhihu.com/p/572780162>《参同真解》WebUI 扩展功能研究(NovelAI)</a></li><li>【NSFW】NovelAI 正统教程，详尽但很多不是那么好用：<a href=https://seesaawiki.jp/nai_ch/>NovelAIのPromptsを収集するWikiです</a></li><li>【NSFW】国人收集整理的Prompt：<a href=https://docs.google.com/spreadsheets/d/e/2PACX-1vRa2HjzocajlsPLH1e5QsJumnEShfooDdeHqcAuxjPKBIVVTHbOYWASAQyfmrQhUtoZAKPri2s_tGxx/pubhtml#>NovelAI 法术书</a></li><li>早期的指引，从这里学到如何强化某个输入，如何调整角度与画幅：<a href=https://dskjal.com/others/waifu-diffusion-workflow.html>Waifu Diffusion で効率的に画像を生成する</a></li><li>一些相关资料介绍：<a href=https://www.activitv.com/entry/stable-diffusion/>話題のお絵かき画像生成AI『Stable Diffusion』の体験・インストール方法・プロンプトのコツ・関連情報のまとめ覚書（Win/Mac/Colab）</a></li></ol></blockquote><hr><h3 id=0a-施法前备忘>0.a 施法前备忘</h3><ul><li>NovelAI 设置<strong>Step大于30，CFG Scale设置11-13</strong></li><li>Waifu Diffusion没有推荐设置，CFG Scale=7.5 然后大力出奇迹（多batch几张，或者用offset检索）</li></ul><p>参考：
<img src=001.webp alt=WebUI></p><p>NovelAI的话，设置Stable Diffusion里这里还要设置下：</p><p><img src=002.webp alt=NovelAI额外设置></p><p>关于这个设置，可以参考<a href=https://github.com/AUTOMATIC1111/stable-diffusion-webui/discussions/2017#discussioncomment-3842186>明日香的这个对比</a>，设置2-4效果是最佳的：</p><p><img src=https://user-images.githubusercontent.com/107586145/194940744-6c218989-7e25-497a-8c37-1e7d1243abab.png alt=asuka></p><p>另外，如果你在公共场合跑，建议增加个 <code>NSFW</code> 的负面词，避免因为一些错误的咒语当场社死</p><blockquote><p>NovelAI的模型可以在<a href=https://369369.xyz/host/topic/1082737.html>这里下载</a>，WD v1.3的直接<a href=https://huggingface.co/hakurei/waifu-diffusion>huggingface</a></p><p>关于搭建可以直接看这篇，不会比整合包难多少：https://github.com/AUTOMATIC1111/stable-diffusion-webui/discussions/2017</p><p>如果不太熟悉Python环境，B站也有很多整合包可以直接用</p></blockquote><h3 id=0b-automatic1111的便利功能介绍>0.b AUTOMATIC1111的便利功能介绍</h3><p>授人以鱼不如授人以渔，首先介绍几个调优的小技巧，方便自行调整召回咒文。</p><h4 id=prompt-matrixhttpsgithubcomautomatic1111stable-diffusion-webuiwikifeaturesprompt-matrix><a href=https://github.com/AUTOMATIC1111/stable-diffusion-webui/wiki/Features#prompt-matrix>Prompt matrix</a></h4><p>这个功能可以通过脚本，自动对比输入的几组prompt影响。在界面最下面选择 <code>Script -> Prompt matrix</code>，然后Prompt里输入 <code>基础Prompt|第一组|第二组</code>，就可以生成类似这样的对比矩阵：</p><p><img src=https://github.com/AUTOMATIC1111/stable-diffusion-webui/wiki/images/prompt_matrix.jpg alt="prompt matrix"></p><p>这个最常用的是对比局部微调，画风，服装等影响</p><h4 id=xy-plothttpsgithubcomautomatic1111stable-diffusion-webuiwikifeaturesxy-plot><a href=https://github.com/AUTOMATIC1111/stable-diffusion-webui/wiki/Features#xy-plot>X/Y plot</a></h4><p>另一个<code>X/Y plot</code>脚本，则用于实验更多的参数指标。例如CFG Scale的步长，随机数生成器:</p><p><img src=https://github.com/AUTOMATIC1111/stable-diffusion-webui/wiki/images/xy_grid-medusa-ui.png alt="xy setup"></p><p>甚至<a href=https://github.com/AUTOMATIC1111/stable-diffusion-webui/discussions/2017#discussioncomment-3836360>hypernetworks在不同seeds下的影响</a></p><p><img src=https://user-images.githubusercontent.com/115398132/194805364-95e523aa-4bec-4a88-9fe1-b3d39d2f2992.jpg alt=hypernetworks></p><blockquote><p>masterpiece, best quality, masterpiece, 1girl, solo, outdoors, flowers, dancing
Negative prompt: nsfw, lowres, bad anatomy, bad hands, text, error, missing fingers, extra digit, fewer digits, cropped, worst quality, low quality, normal quality, jpeg artifacts,signature, watermark, username, blurry, artist name
Steps: 28, Sampler: Euler, CFG scale: 12, Seed: [SEE COLUMN], Size: 512x512, Model hash: 925997e9, Hypernet: [SEE ROW]</p></blockquote><p>更多进阶用法可以参考<a href=https://github.com/AUTOMATIC1111/stable-diffusion-webui/wiki/Features>AUTOMATIC1111 - Detailed feature showcase with images</a>:，后面用到再进行介绍</p><h1 id=1-基础风格>1. 基础风格</h1><p>先描述一下要画的内容，例如 <code>最好的质量，高分辨率，细节满满的壁纸</code>，按照《参同真解》解释这叫咒语的语音语调^_^ 在这个基础上增加其他内容，成图率会高很多</p><blockquote><p>Prompt: {best quality}, {{masterpiece}}, {highres}, original, extremely detailed wallpaper
Neg Prompt: lowres, bad anatomy, bad hands, text, error, missing fingers,extra digit, fewer digits, cropped, worstquality, low quality, normal quality, jpegartifacts, signature, watermark, username, blurry, bad feet</p></blockquote><h2 id=11-绘制基础>1.1 绘制基础</h2><p>人物的描述最为容易（这也是因为训练集中这类图片最多）。因为WD和NoveAI里，都用到了 <a href=https://www.gwern.net/Danbooru2021>Danbooru2021</a> 的训练集，因此Danbooru上热门标签，或者训练集的top标签，对最终结果有很大影响。例如单人，一般<code>girl</code>/<code>1girl</code>，如果想多人可以用 <code>2girls</code>，我们添加后可以得到：</p><p><img src=003.webp alt=1girl></p><blockquote><p>{best quality}, {{masterpiece}}, {highres}, original, extremely detailed wallpaper, {an extremely delicate and beautiful}<strong>|1girl|2girls</strong>
Negative prompt: NSFW. lowres, bad anatomy, bad hands, text, error, missing fingers,extra digit, fewer digits, cropped, worstquality, low quality, normal quality, jpegartifacts, signature, watermark, username, blurry, bad feet
Steps: 45, Sampler: Euler a, CFG scale: 11, Seed: 3448322199, Size: 512x768, Model hash: 925997e9, Clip skip: 2</p></blockquote><p>这种没有任何细节描述的，属于让NovelAI自由发挥。但这个结果有意思的是，同seed不加相反细节最好（这是否说明NovelAI训练时刻意加了权重，对这种画风甚至出现了严重bias）。相比<code>2girls</code>，<code>1girl</code>的训练数据显然更多，两个都存在时只画了1个人</p><h2 id=12-关于-masterpiece-等魔法词>1.2 关于 <code>{{masterpiece}}</code> 等魔法词</h2><p>有一些关键词，可以提升绘制结果的质量。例如 <code>masterpiece</code>杰作，添加后可以通过Prompt矩阵结果，看到同Seed下的明显差异：</p><p><img src=004.webp alt=01_masterpiece.jpg></p><p>从结果可以看到，<code>{{masterpiece}}</code> 强调2次（<a href=https://github.com/AUTOMATIC1111/stable-diffusion-webui/wiki/Features#attentionemphasis>语法解释</a>）后质量确实有提升（无论五官还是衣服）；而另一个 <code>highres</code> 作用有限。当然这个结果也有可能因为seed不同而不稳定，对于影响不那么明显的，具体需要同Prompt多尝试2次才能知道确切的作用</p><h2 id=13-关于背景的处理>1.3 关于背景的处理</h2><p>背景也是可以调整的，如果想生成干净的可以添加 <code>black background</code>，这个强度非常好可以解决大多数背景不协调的问题，方便后面抠图叠加：</p><p><img src=005.webp alt=02_background.png></p><p>当然也可以用 <code>nebula background</code>, <code>magazine cover</code> 这样的描述来一次生成背景，一切看个人喜好。不过这样的后果，有时候会带来一些不那么好的结果。</p><p><code>nebula background</code>会一定概率让衣服上也出现星云，除非对衣服有非常明确的描述指向，或者就是想要这种风格：</p><p><img src=00092-example1.png alt=00092-example1.png></p><blockquote><p>best quality, highres, original, extremely detailed wallpaper, 1girl, long sliver hair, iron cross, poker face, red eyes, an extremely delicate and beautiful, nebula background, {{masterpiece}}
Negative prompt: lowres, bad anatomy, bad hands, text, error, missing fingers,extra digit, fewer digits, cropped, worstquality, low quality, normal quality, jpegartifacts, signature, watermark, username, blurry, bad feet
Steps: 35, Sampler: Euler a, CFG scale: 11, Seed: 3437716200, Size: 640x960, Model hash: 925997e9, Clip skip: 2</p></blockquote><p><code>magazine cover</code>虽然不会让前景出现变化，但杂志的文字很难定制而且基本不知道在说啥：</p><p><img src=00066-example2.png alt=00066-example2.png></p><blockquote><p>{best quality}, {{masterpiece}}, {highres}, original, extremely detailed wallpaper, 1girl, long sliver hair, styled headband, court corset, poker face, red eyes, {an extremely delicate and beautiful, official art, magazine cover
Negative prompt: lowres, bad anatomy, bad hands, text, error, missing fingers,extra digit, fewer digits, cropped, worstquality, low quality, normal quality, jpegartifacts, signature, watermark, username, blurry, bad feet
Steps: 30, Sampler: Euler a, CFG scale: 11, Seed: 2976024332, Size: 512x768, Model hash: 925997e9, Clip skip: 2</p></blockquote><h2 id=14-动作与全身照>1.4 动作与全身照</h2><p>如果你只用前面提到的基础风格，加人物的描述，会看到人物往往只会是上半身（画幅512x768竖图），这时可以通过增加动作描述<code>standing|walking|dancing</code> 中的前2个来修正：</p><p><img src=006_pos.jpg alt=pos></p><p>可以看到<code>standing</code>组的脚最正常，而<code>walking</code>可能因为原本走动的就很难画，AI只能还原出一只脚的样子。而<code>dancing</code>有点出乎意料，看起来是可以和其他2个动作混合的</p><p>从原理上来说，描述脚和裤子的词语也能生成全身照，待实验</p><h2 id=15-关于画风>1.5 关于画风</h2><h3 id=151-风格词与铅笔画>1.5.1 风格词与铅笔画</h3><p>首先，在想要具体画风前，需要先意识到什么是风格词，因为过强的风格词会影响最终出图的倾向，导致出现融合的画风。例如虽然强调了多次 <code>{{{monochrome}}}, {{{gray scale}}}, {{{pencil sketch lines}}}</code>，但结果并不是铅笔画：</p><p><img src=007.webp alt=example1></p><blockquote><p>{best quality}, {highres}, original, extremely detailed wallpaper, 1girl, long sliver hair, styled headband, iron cross, red eyes, {an extremely delicate and beautiful, {{{expressionless}}}, clear face, empty eyes, iron cross, {{{monochrome}}}, {{{gray scale}}}, {{{pencil sketch lines}}}
Negative prompt: lowres, bad anatomy, bad hands, text, error, missing fingers,extra digit, fewer digits, cropped, worstquality, low quality, normal quality, jpegartifacts, signature, watermark, username, blurry, bad feet, blush, troubled eyebrow, cheek
Steps: 35, Sampler: Euler a, CFG scale: 11, Seed: 2599728945, Size: 512x768, Model hash: 925997e9, Clip skip: 2</p></blockquote><p>这里有几个问题，首先是 <code>{best quality}, {highres}, original, extremely detailed wallpaper</code>，乃至 <code>{{masterpiece}}</code> 这类都有可能造成风格的偏移，因为很少有人用铅笔画去做桌面，而且铅笔画一般缺少细节。去掉这些后对比，就正常很多了：</p><p><img src=008.webp alt=example22></p><blockquote><p>1girl, long sliver hair, styled headband, iron cross, {an extremely delicate and beautiful, {{{expressionless}}}, clear face, empty eyes, iron cross|monochrome|gray scale|pencil sketch lines
Negative prompt: lowres, bad anatomy, bad hands, text, error, missing fingers,extra digit, fewer digits, cropped, worstquality, low quality, normal quality, jpegartifacts, signature, watermark, username, blurry, bad feet, blush, troubled eyebrow, cheek
Steps: 35, Sampler: Euler a, CFG scale: 11, Seed: 2599728945.0, Size: 512x768, Model hash: 925997e9, Clip skip: 2</p></blockquote><p>结合自己想要的风格，选取 <code>monochrome</code> 和 <code>{{pencil sketch lines}}</code>，并强调下倾向。相对应的还有 <code>watercolor</code>/<code>pixel art</code> 等风格指向，都可以尝试。</p><p>还有一些好用的，比如<code>chibi</code>Q版；<code>oil painting</code>油画；<code>photo realistic</code>现实照片（会更清晰？）</p><p>画风也会和背景一样，对人物造成影响。例如<code>makoto shinkai</code>（新海誠風）虽然能生成漂亮的天空背景，但混用会影响人物的效果。建议实际时参考背景一节，将前景和背景分开生成再拼接：</p><p><img src=009.webp alt=example3></p><h3 id=152-画师风格词>1.5.2 画师风格词</h3><p>还有一类风格词，是直接描述需要的画师名，或者作品的名称。例如<code>{granblue fantasy}, {official art}</code>：</p><p><img src=010.webp alt=example4></p><blockquote><p>1girl, long sliver hair, styled headband, red eyes, iron cross, {granblue fantasy}, {official art}
Negative prompt: lowres, bad anatomy, bad hands, text, error, missing fingers,extra digit, fewer digits, cropped, worstquality, low quality, normal quality, jpegartifacts, signature, watermark, username, blurry, bad feet, blush, troubled eyebrow, cheek
Steps: 35, Sampler: Euler a, CFG scale: 9, Seed: 716858732, Size: 512x768, Model hash: 925997e9, Clip skip: 2</p></blockquote><p>一份官方机甲风立绘就有了</p><p>（未完待续）</p></div><div class=post-footer></div></article></main></body></html>